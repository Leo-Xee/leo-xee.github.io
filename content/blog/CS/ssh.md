---
title: SSH
date: 2022-04-29 02:07:08
category: CS
thumbnail: { thumbnailSrc }
draft: false
---

![](./images/thumbNail/thumbNail.gif)

# SSH란?

**SSH(Secure Shell)는 원격 호스트에 접속하기 위해 사용되는 보안 프로토콜이다.** 기존 원격 접속은 텔넷(Telnet)이라는 방식을 사용했는데 암호화를 제공하지 않기 때문에 보안이 취약하다는 단점이 있었다. 이 때문에 이를 암호화하는 SSH가 등장했고 현재 원격 접속 보안을 위한 필수적인 요소로 자리 잡았다. 또한 클라우드 서비스에서 제공하는 서버는 기본적으로 원격 접속으로 접근하고 사용한다. 그래서 AWS와 같은 클라우드 서비스에서 서버 생성 시에 SSH를 기본적으로 사용한다.

# 동작 방식

![그림1. SSH의 동작 과정](./images/ssh-01.png)

SSH는 대칭키 방식과 비대칭키 방식을 모두 사용해서 사용자 인증과 데이터 암호화를 수행한다. 가장 먼저 클라이언트와 서버가 서로의 정체를 인증해야하는데 이 때 비대칭키 방식을 사용하고 이 후에 데이터를 전송할 때 대칭키 방식을 사용한다.

## 사용자 인증

클라이언트가 비대칭키(공개키, 비밀키)를 생성할 경우에 개인 키는 사용자가 보관하고 공개 키는 서버에 복사해둔다. 그 다음 서버에서 공개 키로 난수 값을 생성하고 해시값을 만들어 저장한다. 서버는 난수값을 암호화해 클라이언트에게 전송하게 되고 클라이언트에서 암호화된 난수값을 비밀키로 복호화한다. 복호환된 값으로 해시값을 생성해 다시 서버에게 전송한다. 그럼 서버는 기존에 저장하고 있던 해시값과 전송받은 해시값을 비교해 동일하면 정상적인 클라이언트로 인지하게 된다.

## 데이터 암호화

인증이 완료되면 비대칭 키를 통해서 클라이언트와 서버는 대칭키를 서로 교환한다. 그 이후 통신되는 모든 데이터는 대칭 키(세션 키)를 통해서 암호화가 이루어진다.

<br>

> 암호화 방식에는 대칭키와 비대칭키 방식이 있다. 대칭키방식이란 동일한 키로 암호화와 복호화를 하는 방식이고 비대칭키 방식은 암호화와 복호화에 서로 다른 키를 사용하는 방식이다.

# 사용

## SSH key 존재여부 확인

다음의 명령어를 통해 해당 위치에 `id_rsa` 와 `id_rsa_pub` 파일이 존재하지 않으면 SSH key가 존재하지 않는다는 의미이다.

```bash
$ ~/.ssh
$ ls -al
```

## SSH key 생성

존재하지 않을 경우에 아래의 명령어로 SSH키를 생성한다.

```bash
$ ssh-keygen
```

위의 명령어를 입력하면 파일명이나 경로를 설정할 수 있다. 파일명이나 경로를 다르게 설정할 경우에 적용 시에 문제가 생길 수도 있기 때문에 보통은 Enter키로 기본 생성한다.

```bash
$ Generating public/private rsa key pair.
$ Enter file in which to save the key (/Users/mac/.ssh/id_rsa):
```

파일명과 경로 설정이 완료되면 SSH key의 비밀번호를 설정한다.

```bash
$ Enter passphrase (empty for no passphrase): < 사용할 비밀번호 입력 >
$ Enter same passphrase again: < 사용할 비밀번호 재입력 >
```

`~/.ssh`의 위치에 비밀키(`id_rsa`)와 공개키(`id_rsa_pub`)라는 SSH key가 정상적으로 생성된 것을 확인할 수 있다.

# 참조

- https://library.gabia.com/contents/infrahosting/9002/
- https://medium.com/@labcloud/ssh-%EC%95%94%ED%98%B8%ED%99%94-%EC%9B%90%EB%A6%AC-%EB%B0%8F-aws-ssh-%EC%A0%91%EC%86%8D-%EC%8B%A4%EC%8A%B5-33a08fa76596

<br/>
